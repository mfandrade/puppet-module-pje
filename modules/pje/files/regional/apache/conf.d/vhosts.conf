# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for requests without a known
# server name.

# NameVirtualHost is required for name based
NameVirtualHost 10.X.X.X:80

# VirtualHost com mod_jk para primeiro e segundo graus
<VirtualHost 10.X.X.X:80>
    ServerName pje.trtXX.jus.br

    # KeepAlive: Whether or not to allow persistent connections (more than
    # one request per connection). Set to "Off" to deactivate.
    KeepAlive On

    # MaxKeepAliveRequests: The maximum number of requests to allow
    # during a persistent connection. Set to 0 to allow an unlimited amount.
    # We recommend you leave this number high, for maximum performance.
    MaxKeepAliveRequests 0

    # KeepAliveTimeout: Number of seconds to wait for the next request from the
    # same client on the same connection.
    KeepAliveTimeout 60

    # To avoid users of your website / application from being able to retrieve a listing of files in a directory,
    # turn off the Indexes flag using the Option directive as follows:
    Options -Indexes FollowSymLinks

    # mod_cache config
    Include conf.d/mod_cache.include

    # mod_expires config
    Include conf.d/mod_expires.include

    # mod_deflate config
    Include conf.d/mod_deflate.include
	
	# mod_cband config
	#Include conf.d/mod_cband.include
	
	# mod_jk config
	Include conf.d/jk.include    


    # Arquivos de log do PJe
    ErrorLog logs/pje-error_log
    CustomLog logs/pje-access_log common

    # Status do balanceamento com mod_jk
    JkMount /jk/* jkstatus
	<Location /jk>
    	JkMount jkstatus
    	Order deny,allow
    	Deny from all
    	Allow from 10.X
    </Location>

    JkMount /primeirograu* loadbalancer-pje-1grau
    JkMount /segundograu*  loadbalancer-pje-2grau 
	JkMount /visualizador* loadbalancer-visualizador
	JkMount /consulta* loadbalancer-consulta

    # Configuracoes do mod_cband
    # taxa de download | conexoes por segundo | conexoes simultaneas
    #CBandSpeed 10000kbps 3000 3000
    #CBandRemoteSpeed 2000kbs 300 300
    #<Location /cb>
    #  	SetHandler cband-status
    #  	Order deny,allow
    #  	Deny from all
    #  	Allow from 10.X
    #</Location>
    
	# [PJE-4104] - Melhoria na solucao de Sessao de Julgamento
    # Redirecionamentos para o endereco da sala de sessao
#    <Location /segundograu/Painel/SecretarioSessao>
#      Deny from all
#      ErrorDocument 403 "<html><body bgcolor=#F2F7FB>Para a sala de sess&atilde;o utilize o link abaixo.<br><a href='http://sessao.pje.trtXX.jus.br'>Sala de sess&atilde;o</a></body></html>"
#    </Location>

#    <Location /segundograu/Painel/painel_usuario/Painel_Usuario_Magistrado_2_Grau>
#      Deny from all
#      ErrorDocument 403 "<html><body bgcolor=#F2F7FB>Para a sala de sess&atilde;o utilize o link abaixo.<br><a href='http://sessao.pje.trtXX.jus.br'>Sala de sess&atilde;o</a></body></html>"
#    </Location>
	
#	<Location /segundograu/testeSessao.seam>
#      Deny from all
#       ErrorDocument 403 "<html><body bgcolor=#F2F7FB>Para testar a sala de sess&atilde;o utilize o link abaixo para fazer um novo login e em seguida acesse /segundograu/testeSessao.seam <br><a href='http://sessao.pje.trtXX.jus.br'>Sala de sess&atilde;o</a></body></html>"
#    </Location>

#--------------------

	# Bloqueio de webservices no acesso externo 
	#<LocationMatch "^/.*/(servicosweb|monitoracao)">
	<LocationMatch "^/.*/(intercomunicacao$|monitoracao)">
       Order deny,allow
       Deny from all
       Allow from 10.X
    </LocationMatch>
	 
	 
#Obs: é necessário mudar o valor X na linha "Allow from 10.X” para o número correspondente
#a rede do regional. 
#Exemplos:
#TST = Allow from 10.0
#TRT1 = Allow from 10.1
#TRT2 = Allow from 10.2
#...
#TRT24 = Allow from 10.24  
#----------------------	 

#Redirecionamento permanente de tudo que chega na porta 80 para a 443
#Substituir o XX pelo numero do regional em questao
     RedirectPermanent / https://trtXX.pje.csjt.jus.br/

</VirtualHost>