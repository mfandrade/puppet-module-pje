#!/bin/sh
# chkconfig: 345 90 10
# description: PJE JBoss wrapper init script

SCRIPT_1GRAU=<%= scope['::pje::params::jboss_home'] %>/bin/pje-1grau-default.sh
SCRIPT_2GRAU=<%= scope['::pje::params::jboss_home'] %>/bin/pje-2grau-default.sh

if [[ $# -eq 0  ]]; then
    echo "Usage: $0 {start|stop|restart|kill|status} <1grau|2grau>"
    exit 1

elif [[ $# -eq 1 ]]; then

    # TODO: possível lógica para saída (espera-se não necessária)
    #EXITCODE=0
    #if [[ -x $SCRIPT_1GRAU ]]; then
    #    EXITCODE=$($SCRIPT_1GRAU "$1")
    #fi 
    #if [[ -x $SCRIPT_2GRAU ]]; then
    #    EXITCODE=$($SCRIPT_2GRAU "$1" || $EXITCODE)
    #fi 
    #exit $EXITCODE
                                    
    if [[ -x $SCRIPT_1GRAU ]]; then
        $SCRIPT_1GRAU "$1"
    fi  
    if [[ -x $SCRIPT_2GRAU ]]; then
        $SCRIPT_2GRAU "$1"
    fi  

elif [[ $# -ge 2 ]]; then

    if [[ "$2" = "1grau" ]]; then
        if [[ -x $SCRIPT_1GRAU ]]; then
            $SCRIPT_1GRAU "$1"
        fi  
    elif [[ "$2" = "2grau" ]]; then
        if [[ -x $SCRIPT_2GRAU ]]; then
            $SCRIPT_2GRAU "$1"
        fi  
    else
        echo "PJE '$2' is an invalid instance"
        exit 4
    fi
fi
